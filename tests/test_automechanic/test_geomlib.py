""" test the automechanic.geomlib module
"""
from automechanic import geomlib


def test__find_hydrogen_abstraction():
    """ test geomlib.find_hydrogen_abstraction()
    """
    q1h_mgeo = (('O', (0.93765321301, -0.0694961347519, 0.0634458694842)),
                ('H', (0.658804017340, 0.569095658158, -0.609907417816)),
                ('H', (1.905540138587, -0.0375451195842, 0.02975561330711)))
    q2_mgeo = (('C', (1.057143885742, -0.0871511930619, -0.04674477657599)),
               ('C', (0.549259085892, -0.51012990525, -1.382882296554)),
               ('C', (-0.260448372050, -1.56319708610, -1.571575720915)),
               ('C', (-0.802023847371, -1.875359353914, -2.86287569869)),
               ('H', (-1.831195698706, -2.217304257490, -2.903573753718)),
               ('H', (-0.3887895375297, -1.405145731255, -3.748801522373)),
               ('H', (0.717942748466, -0.751768637238, 0.753718816634)),
               ('H', (0.69883028665, 0.923100928024, 0.1753578686900)),
               ('H', (2.150618291809, -0.0751291554072, -0.0472355720243)),
               ('H', (0.835509225958, 0.1125614404805, -2.22639811658)),
               ('H', (-0.576160339695, -2.182154423569, -0.735490006800)))
    q1_mgeo = (('O', (0.93765321301, -0.0694961347519, 0.0634458694842)),
               ('H', (1.905540138587, -0.0375451195842, 0.02975561330711)))
    q2h_mgeo = (('C', (1.059090261904, -0.0718353638623, 0.04370704218484)),
                ('C', (0.556035954077, -0.90540792220, -1.123283339366)),
                ('C', (1.01445783999, -2.32896395175, -1.007525457144)),
                ('C', (0.173740564627, -3.36721182331, -0.912436813201)),
                ('H', (0.703588929571, -0.47507467027, 0.998119886727)),
                ('H', (0.699161807464, 0.957951796736, -0.04438185099025)),
                ('H', (2.15372170793, -0.0479363138861, 0.0699595361787)),
                ('H', (-0.538544477665, -0.851175773075, -1.156172783989)),
                ('H', (0.926067547432, -0.484854481009, -2.065094239189)),
                ('H', (2.08749601614, -2.510032851609, -1.00152436791)),
                ('H', (0.545891741187, -4.38245608386, -0.824307699115)),
                ('H', (-0.902201513087, -3.223842453531, -0.91726794081)))
    idxs = geomlib.find_hydrogen_abstraction(
        q1h_mgeo, q2_mgeo, q1_mgeo, q2h_mgeo)
    assert idxs == (2, 1, 0, 8)


if __name__ == '__main__':
    test__find_hydrogen_abstraction()
