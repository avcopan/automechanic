""" test the automechanic.geomlib module
"""
from automechanic import geomlib


def test__addition_indices():
    """ test geomlib.addition_indices()
    """
    x_mgeo = (('O', (0.952632526586, -0.0627316796020, 0.0080078583889)),
              ('H', (1.892440257233, -0.0627316796020, 0.0080078583889)))
    y_mgeo = (('C', (0.999749614329, 0.0815463557276, -0.05313151319214)),
              ('C', (0.2941554428798, -0.1333084924908, 1.06457863301)),
              ('C', (-1.198418794122, -0.141000266906, 1.104594274387)),
              ('H', (0.50843512849, 0.2642722240302, -1.003700339629)),
              ('H', (2.084674708630, 0.0790932629613, -0.040370798372)),
              ('H', (0.817176204583, -0.313348598161, 2.00117588120)),
              ('H', (-1.559370502273, -1.112686909705, 1.454564921229)),
              ('H', (-1.559370055401, 0.631682276162, 1.789879903006)),
              ('H', (-1.63349683031, 0.0486453884978, 0.1180237523367)))
    xy_mgeo = (('C', (0.977343848365, -0.0764188131994, 0.13889740679)),
               ('H', (0.4624939859419, -1.02959411007, 0.155086468595)),
               ('H', (0.4440163978138, 0.783646033730, 0.528720307800)),
               ('C', (2.455537814018, -0.01753155811344, -0.002585548076801)),
               ('O', (2.853647414718, -0.998191131877, -0.945748607211)),
               ('C', (2.93814855121, 1.339952372503, -0.48915762596)),
               ('H', (2.921436713659, -0.251407370808, 0.959743143408)),
               ('H', (2.55606620911, -1.86222435081, -0.612788411425)),
               ('H', (2.608102938152, 2.147148597200, 0.172659593754)),
               ('H', (4.03290647398, 1.356511004561, -0.532775456763)),
               ('H', (2.58295049411, 1.55110745037, -1.504509980310)))

    assert geomlib.addition_indices(x_mgeo, y_mgeo, xy_mgeo) == (0, 1, 4, 3)


def test__abstraction_indices():
    """ test geomlib.abstraction_indices()
    """
    q1h_mgeo = (('O', (0.93765321301, -0.0694961347519, 0.0634458694842)),
                ('H', (0.658804017340, 0.569095658158, -0.609907417816)),
                ('H', (1.905540138587, -0.0375451195842, 0.02975561330711)))
    q2_mgeo = (('C', (1.057143885742, -0.0871511930619, -0.04674477657599)),
               ('C', (0.549259085892, -0.51012990525, -1.382882296554)),
               ('C', (-0.260448372050, -1.56319708610, -1.571575720915)),
               ('C', (-0.802023847371, -1.875359353914, -2.86287569869)),
               ('H', (-1.831195698706, -2.217304257490, -2.903573753718)),
               ('H', (-0.3887895375297, -1.405145731255, -3.748801522373)),
               ('H', (0.717942748466, -0.751768637238, 0.753718816634)),
               ('H', (0.69883028665, 0.923100928024, 0.1753578686900)),
               ('H', (2.150618291809, -0.0751291554072, -0.0472355720243)),
               ('H', (0.835509225958, 0.1125614404805, -2.22639811658)),
               ('H', (-0.576160339695, -2.182154423569, -0.735490006800)))
    q1_mgeo = (('O', (0.93765321301, -0.0694961347519, 0.0634458694842)),
               ('H', (1.905540138587, -0.0375451195842, 0.02975561330711)))
    q2h_mgeo = (('C', (1.059090261904, -0.0718353638623, 0.04370704218484)),
                ('C', (0.556035954077, -0.90540792220, -1.123283339366)),
                ('C', (1.01445783999, -2.32896395175, -1.007525457144)),
                ('C', (0.173740564627, -3.36721182331, -0.912436813201)),
                ('H', (0.703588929571, -0.47507467027, 0.998119886727)),
                ('H', (0.699161807464, 0.957951796736, -0.04438185099025)),
                ('H', (2.15372170793, -0.0479363138861, 0.0699595361787)),
                ('H', (-0.538544477665, -0.851175773075, -1.156172783989)),
                ('H', (0.926067547432, -0.484854481009, -2.065094239189)),
                ('H', (2.08749601614, -2.510032851609, -1.00152436791)),
                ('H', (0.545891741187, -4.38245608386, -0.824307699115)),
                ('H', (-0.902201513087, -3.223842453531, -0.91726794081)))
    idxs = geomlib.abstraction_indices(
        q1h_mgeo, q2_mgeo, q1_mgeo, q2h_mgeo)
    assert idxs == (2, 1, 0, 8)

    q1h_mgeo = (('O', (1.160649880891, 0.0627978268174, -0.0408330725075)),
                ('O', (0.670030192617, -0.810012591664, 1.01847301649)),
                ('C', (-0.762764327328, -0.771623494653, 0.971879813498)),
                ('C', (-1.286027334011, 0.630975793141, 1.25724343361)),
                ('C', (-1.286025794377, -1.319989887595, -0.350244634965)),
                ('H', (2.10820223046, -0.0822581224768, 0.135216457591)),
                ('H', (-1.10626335348, -1.433832526376, 1.775585055636)),
                ('H', (-0.959411887323, 1.34277748802, 0.4919543629624)),
                ('H', (-2.37990142664, 0.642772565761, 1.288621209488)),
                ('H', (-0.902576311752, 0.995523287157, 2.215796882617)),
                ('H', (-0.9025737237, -2.330572084284, -0.524722174920)),
                ('H', (-2.379899853887, -1.353045699721, -0.3558229455)),
                ('H', (-0.959410238052, -0.70497322095, -1.195279213213)))
    q2_mgeo = (('O', (1.07394324121, 0.0501743774966, 0.0668114667428)),
               ('O', (2.355943241199, 0.0501743774966, 0.0668114667428)))
    q1_mgeo = (('O', (1.01849391329, 0.02212499683403, 0.0463288404118)),
               ('O', (2.424344519778, -0.02924375645281, 0.05658010669234)),
               ('C', (2.80314339128, -1.38272890920, 0.3266805371647)),
               ('C', (2.338504665743, -1.833731474576, 1.707956931019)),
               ('C', (2.338505036357, -2.329364870800, -0.775684415566)),
               ('H', (3.89891588452, -1.38511658503, 0.327157185309)),
               ('H', (1.246260227299, -1.860092545692, 1.776726361401)),
               ('H', (2.71835895531, -2.83374919094, 1.940450620285)),
               ('H', (2.690750920592, -1.13759031891, 2.476303244045)),
               ('H', (2.690751556464, -1.981462639680, -1.752379053941)),
               ('H', (2.7183593275, -3.34202255559, -0.606530163155)),
               ('H', (1.24626061603, -2.380102757813, -0.829068367911)))
    q2h_mgeo = (('O', (1.09332243633, -0.0516790137299, -0.01278085883290)),
                ('O', (0.596198306921, -1.092054935846, -0.810333075830)),
                ('H', (2.065302405982, -0.05663139196237, -0.016577352153)))
    assert (geomlib.abstraction_indices(q1h_mgeo, q2_mgeo, q1_mgeo, q2h_mgeo)
            == (5, 1, 0, 2))


if __name__ == '__main__':
    test__abstraction_indices()
    test__addition_indices()
